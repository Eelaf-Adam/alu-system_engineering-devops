#!/usr/bin/env bash
# Configures Nginx to add a custom HTTP header X-Served-By with the server hostname

set -e

# Install nginx if not already installed
if ! command -v nginx &> /dev/null; then
    apt-get update -y
    apt-get install -y nginx
fi

# Start and enable nginx
systemctl start nginx
systemctl enable nginx

# Add custom header
echo "add_header X-Served-By \$hostname;" | sudo tee /etc/nginx/conf.d/custom_header.conf > /dev/null

# Test and reload nginx
sudo nginx -t
sudo systemctl reload nginx
